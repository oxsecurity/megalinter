descriptor_id: REPOSITORY
descriptor_type: other
descriptor_flavors:
  - all_flavors # Applicable to CI in any language project
  - ci_light
  - security
lint_all_files: true
install:
  dockerfile:
    - RUN git config --global core.autocrlf true
linters:
  # GIT_DIFF
  - linter_name: git_diff
    lint_all_files: true
    test_folder: git_diff
    linter_text: Git diff checks for git conflicts markers in files
    linter_url: https://git-scm.com
    linter_repo: https://github.com/git/git
    linter_spdx_license: LGPL-2.1
    linter_megalinter_ref_url: never
    cli_config_arg_name: ""
    cli_executable: git
    cli_lint_mode: project
    cli_lint_extra_args:
      - "diff"
      - "--check"
    cli_help_arg_name: "--help"
    examples:
      - "git diff --check"

  # SECRETLINT
  - linter_name: secretlint
    linter_url: https://github.com/secretlint/secretlint
    linter_repo: https://github.com/secretlint/secretlint
    linter_banner_image_url: https://github.com/secretlint/secretlint/raw/main/docs/assets/SecretLintLP.png
    linter_rules_url: https://github.com/secretlint/secretlint#rule-packages
    linter_rules_configuration_url: https://github.com/secretlint/secretlint#configuration
    linter_megalinter_ref_url: https://github.com/secretlint/secretlint#mega-linter
    config_file_name: .secretlintrc.json
    cli_config_arg_name: "--secretlintrc"
    cli_lint_mode: project
    cli_lint_extra_args_after:
      - "**/*"
    cli_help_arg_name: "--help"
    test_folder: credentials
    examples:
      - 'secretlint "*/**"'
      - 'secretlint --secretlintrc .secretlintrc.json "**/*"'
    downgraded_version: true
    install:
      npm:
        - secretlint@4.1.0
        - "@secretlint/secretlint-rule-preset-recommend@4.1.0"

  # GITLEAKS
  - linter_name: gitleaks
    linter_url: https://github.com/zricethezav/gitleaks
    linter_repo: https://github.com/zricethezav/gitleaks
    linter_rules_configuration_url: https://github.com/zricethezav/gitleaks#configuration
    config_file_name: gitleaks.toml
    cli_config_arg_name: "--config-path"
    cli_lint_mode: project
    cli_lint_extra_args_after:
      - "--path=."
      - "--no-git"
      - "--verbose"
    linter_version_cache: "0.0.0" # TODO: retrieve gitleaks version
    cli_help_arg_name: --help
    help_command_return_code: 1
    test_folder: credentials
    examples:
      - "gitleaks"
      - "gitleaks --config-path gitleaks.toml"
    install:
      dockerfile:
        - RUN GO111MODULE=on go get github.com/zricethezav/gitleaks/v7

  # GOODCHECK
  - linter_name: goodcheck
    linter_url: https://sider.github.io/goodcheck/
    linter_repo: https://github.com/sider/goodcheck
    linter_rules_url: https://sider.github.io/goodcheck/docs/rules
    linter_rules_configuration_url: https://sider.github.io/goodcheck/docs/configuration
    active_only_if_file_found:
      - goodcheck.yml
    config_file_name: goodcheck.yml
    cli_config_arg_name: "-c"
    cli_lint_mode: project
    cli_lint_extra_args:
      - check
    cli_help_arg_name: "help"
    test_folder: repository_goodcheck
    examples:
      - "goodcheck check"
      - "goodcheck check -c goodcheck.yml"
    install:
      gem:
        - goodcheck

  # TRIVY
  - linter_name: trivy
    linter_url: https://aquasecurity.github.io/trivy/
    linter_repo: https://github.com/aquasecurity/trivy
    linter_banner_image_url: https://aquasecurity.github.io/trivy/v0.21.1/imgs/logo.png
    cli_lint_mode: project
    cli_lint_extra_args:
      - "config"
    test_folder: trivy
    examples:
      - 'trivy config'
    install:
      dockerfile:
        - RUN curl -sfL https://raw.githubusercontent.com/aquasecurity/trivy/main/contrib/install.sh | sh -s -- -b /usr/local/bin v0.21.1
