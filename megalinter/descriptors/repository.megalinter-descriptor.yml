descriptor_id: REPOSITORY
descriptor_type: other
descriptor_flavors:
  - all_flavors # Applicable to CI in any language project
  - ci_light
lint_all_files: true
linters:
  # GIT_DIFF
  - linter_name: git_diff
    lint_all_files: true
    test_folder: git_diff
    linter_text: Git diff checks for git conflicts markers in files
    linter_url: https://git-scm.com
    linter_repo: https://github.com/git/git
    linter_spdx_license: LGPL-2.1
    linter_megalinter_ref_url: never
    cli_config_arg_name: ""
    cli_executable: git
    cli_lint_mode: project
    cli_lint_extra_args:
      - "diff"
      - "--check"
    cli_help_arg_name: "--help"
    examples:
      - "git diff --check"

  # GITLEAKS
  - linter_name: gitleaks
    can_output_sarif: true
    descriptor_flavors:
      - all_flavors # Applicable to CI in any language project
      - ci_light
      - security
    linter_url: https://github.com/zricethezav/gitleaks
    linter_repo: https://github.com/zricethezav/gitleaks
    linter_rules_configuration_url: https://github.com/zricethezav/gitleaks#configuration
    config_file_name: .gitleaks.toml
    cli_config_arg_name: "-c"
    cli_lint_mode: project
    cli_lint_extra_args:
      - detect
    cli_sarif_args:
      - --report-format
      - sarif
      - --report-path
      - "{{SARIF_OUTPUT_FILE}}"
    cli_lint_extra_args_after:
      - "--no-git"
      - "--verbose"
      - "--source"
      - "."
    linter_version_cache: "0.0.0" # TODO: retrieve gitleaks version
    cli_help_arg_name: help
    cli_lint_errors_count: regex_sum
    cli_lint_errors_regex: "leaks found: ([0-9]+)"
    test_folder: gitleaks
    examples:
      - "gitleaks detect --no-git --verbose --source ."
      - "gitleaks detect -c .gitleaks.toml --no-git --verbose --source ."
    install:
      dockerfile:
        - FROM zricethezav/gitleaks:latest as gitleaks
        - COPY --from=gitleaks /usr/bin/gitleaks /usr/bin/

  # GOODCHECK
  - linter_name: goodcheck
    descriptor_flavors:
      - all_flavors # Applicable to CI in any language project
      - ci_light
    linter_url: https://sider.github.io/goodcheck/
    linter_repo: https://github.com/sider/goodcheck
    linter_rules_url: https://sider.github.io/goodcheck/docs/rules
    linter_rules_configuration_url: https://sider.github.io/goodcheck/docs/configuration
    active_only_if_file_found:
      - goodcheck.yml
    config_file_name: goodcheck.yml
    cli_config_arg_name: "-c"
    cli_lint_mode: project
    cli_lint_extra_args:
      - check
    cli_help_arg_name: "help"
    test_folder: repository_goodcheck
    examples:
      - "goodcheck check"
      - "goodcheck check -c goodcheck.yml"
    install:
      gem:
        - goodcheck

  # SEMGREP
  - class: SemgrepLinter
    linter_name: semgrep
    can_output_sarif: true
    descriptor_flavors:
      - all_flavors # Applicable to CI in any language project
      - security
    linter_url: https://semgrep.dev/
    linter_repo: https://github.com/returntocorp/semgrep
    linter_text: |
      If you do not want to use default semgrep recommended rules, you can send them as arguments

      Example:  `REPOSITORY_SEMGREP_ARGUMENTS: ["--config","p/ruleset1","p/ruleset2"]`
    linter_rules_url: https://semgrep.dev/r
    linter_rules_configuration_url: https://semgrep.dev/docs/running-rules/
    linter_rules_inline_disable_url: https://semgrep.dev/docs/ignoring-findings/#inline-comments
    cli_lint_mode: project
    cli_config_arg_name: --config
    cli_config_default_value: auto
    cli_lint_extra_args:
      - --error # Exit 1 when errors are found
    cli_lint_extra_args_after:
      - "{{WORKSPACE}}"
    cli_lint_fix_arg_name: --autofix
    cli_sarif_args:
      - --sarif
    cli_help_arg_name: -h
    cli_help_extra_args: ["--help"]
    test_folder: repository_semgrep
    examples:
      - "semgrep /tmp/lint"
      - "semgrep "
    install:
      pip:
        - semgrep
    variables:
      - name: REPOSITORY_SEMGREP_RULESETS
        description: List of semgrep rulesets identifiers that you want to enforce
        default_value: auto
      - name: REPOSITORY_SEMGREP_RULESETS_TYPE
        description: "MegaLinter semgrep ruleset list preset id . Available values: security"
        default_value: ""

  # SECRETLINT
  - linter_name: secretlint
    descriptor_flavors:
      - all_flavors # Applicable to CI in any language project
      - ci_light
      - security
    linter_url: https://github.com/secretlint/secretlint
    linter_repo: https://github.com/secretlint/secretlint
    linter_banner_image_url: https://github.com/secretlint/secretlint/raw/main/docs/assets/SecretLintLP.png
    linter_rules_url: https://github.com/secretlint/secretlint#rule-packages
    linter_rules_configuration_url: https://github.com/secretlint/secretlint#configuration
    linter_megalinter_ref_url: https://github.com/secretlint/secretlint#mega-linter
    config_file_name: .secretlintrc.json
    cli_config_arg_name: "--secretlintrc"
    cli_lint_mode: project
    cli_lint_extra_args_after:
      - "**/*"
    cli_help_arg_name: "--help"
    test_folder: credentials
    examples:
      - 'secretlint "*/**"'
      - 'secretlint --secretlintrc .secretlintrc.json "**/*"'
    downgraded_version: true
    install:
      npm:
        - secretlint@4.1.0
        - "@secretlint/secretlint-rule-preset-recommend@4.1.0"

  # TRIVY
  - linter_name: trivy
    can_output_sarif: true
    descriptor_flavors:
      - all_flavors # Applicable to CI in any language project
      - ci_light
      - security
    linter_url: https://aquasecurity.github.io/trivy/
    linter_repo: https://github.com/aquasecurity/trivy
    linter_banner_image_url: https://aquasecurity.github.io/trivy/v0.21.1/imgs/logo.png
    cli_lint_mode: project
    cli_sarif_args:
      - --format
      - template
      - --template
      - /usr/local/bin/sarif.tpl
      - -o
      - "{{SARIF_OUTPUT_FILE}}"
    cli_lint_extra_args:
      - fs
      - --security-checks
      - vuln,config
      - --exit-code
      - "1"
    cli_lint_extra_args_after:
      - "."
    test_folder: trivy
    examples:
      - "trivy fs --security-checks vuln,config ."
    install:
      dockerfile:
        - |
          RUN wget --tries=5 -q https://raw.githubusercontent.com/aquasecurity/trivy/main/contrib/install.sh | sh -s -- -b /usr/local/bin v0.22.0 && \
              wget --tries=5 -q -O /usr/local/bin/sarif.tpl https://raw.githubusercontent.com/aquasecurity/trivy/main/contrib/sarif.tpl
