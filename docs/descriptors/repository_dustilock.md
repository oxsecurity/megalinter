<!-- markdownlint-disable MD033 MD041 -->
<!-- @generated by .automation/build.py, please do not update manually -->

<div align="center">
  <a href="https://github.com/Checkmarx/dustilock#readme" target="blank" title="Visit linter Web Site">
    <img src="https://user-images.githubusercontent.com/1287098/142776854-83abf265-a1ba-485f-a8b6-995da7f7ef8b.png" alt="dustilock" height="150px" class="megalinter-banner">
  </a>
</div>

[![GitHub last commit](https://img.shields.io/github/last-commit/Checkmarx/dustilock)](https://github.com/Checkmarx/dustilock/commits)

## dustilock documentation

- Visit [Official Web Site](https://github.com/Checkmarx/dustilock#readme){target=_blank}

[![dustilock - GitHub](https://gh-card.dev/repos/Checkmarx/dustilock.svg?fullname=)](https://github.com/Checkmarx/dustilock){target=_blank}

## Configuration in MegaLinter

- Enable dustilock by adding `REPOSITORY_DUSTILOCK` in [ENABLE_LINTERS variable](https://oxsecurity.github.io/megalinter/latest/configuration/#activation-and-deactivation)
- Disable dustilock by adding `REPOSITORY_DUSTILOCK` in [DISABLE_LINTERS variable](https://oxsecurity.github.io/megalinter/latest/configuration/#activation-and-deactivation)

| Variable | Description | Default value |
| ----------------- | -------------- | -------------- |
| REPOSITORY_DUSTILOCK_ARGUMENTS | User custom arguments to add in linter CLI call<br/>Ex: `-s --foo "bar"` |  |
| REPOSITORY_DUSTILOCK_FILE_EXTENSIONS | Allowed file extensions. `"*"` matches any extension, `""` matches empty extension. Empty list excludes all files<br/>Ex: `[".py", ""]` | Exclude every file |
| REPOSITORY_DUSTILOCK_FILE_NAMES_REGEX | File name regex filters. Regular expression list for filtering files by their base names using regex full match. Empty list includes all files<br/>Ex: `["Dockerfile(-.+)?", "Jenkinsfile"]` | Include every file |
| REPOSITORY_DUSTILOCK_PRE_COMMANDS | List of bash commands to run before the linter| None |
| REPOSITORY_DUSTILOCK_POST_COMMANDS | List of bash commands to run after the linter| None |
| REPOSITORY_DUSTILOCK_DISABLE_ERRORS | Run linter but consider errors as warnings | `false` |
| REPOSITORY_DUSTILOCK_DISABLE_ERRORS_IF_LESS_THAN | Maximum number of errors allowed | `0` |

## MegaLinter Flavours

This linter is available in the following flavours

| <!-- --> | Flavor | Description | Embedded linters | Info |
| :------: | :----- | :---------- | :--------------: | ---: |
| <img src="https://github.com/oxsecurity/megalinter/raw/main/docs/assets/images/mega-linter-square.png" alt="" height="32px" class="megalinter-icon"></a> | [all](https://oxsecurity.github.io/megalinter/latest/supported-linters/) | Default MegaLinter Flavor | 102 | ![Docker Image Size (tag)](https://img.shields.io/docker/image-size/oxsecurity/megalinter/v6) ![Docker Pulls](https://img.shields.io/docker/pulls/oxsecurity/megalinter) |
| <img src="https://github.com/oxsecurity/megalinter/raw/main/docs/assets/icons/security.ico" alt="" height="32px" class="megalinter-icon"></a> | [security](https://oxsecurity.github.io/megalinter/latest/flavors/security/) | Optimized for security | 20 | ![Docker Image Size (tag)](https://img.shields.io/docker/image-size/oxsecurity/megalinter-security/v6) ![Docker Pulls](https://img.shields.io/docker/pulls/oxsecurity/megalinter-security) |

## Behind the scenes

### How are identified applicable files

- If this linter is active, all files will always be linted

<!-- markdownlint-disable -->
<!-- /* cSpell:disable */ -->
### How the linting is performed

dustilock is called once on the whole project directory

- filtering can not be done using MegaLinter configuration variables,it must be done using dustilock configuration or ignore file (if existing)
- `VALIDATE_ALL_CODEBASE: false` does not make dustilock analyze only updated files

### Example calls

```shell
dustilock
```


### Help content

```shell
usage: DustiLock [-h|--help] [-r|--recursive] [-a|--audit] [-p|--path
                 "<value>"]

                 a tool to find which of your dependencies is susceptible to
                 Dependency Confusion attack

Arguments:

  -h  --help       Print help information
  -r  --recursive  scan all files recursively
  -a  --audit      audit only mode
  -p  --path       the path to scan. default is cwd


```

### Installation on mega-linter Docker image

- Dockerfile commands :
```dockerfile
RUN ML_THIRD_PARTY_DIR=/download/dustilock && \
    mkdir -p ${ML_THIRD_PARTY_DIR} && \
    git clone https://github.com/Checkmarx/dustilock.git ${ML_THIRD_PARTY_DIR} && \
    cd ${ML_THIRD_PARTY_DIR} && \
    go build && \
    chmod +x dustilock && \
    mv "${ML_THIRD_PARTY_DIR}/dustilock" /usr/bin/ && \
    find ${ML_THIRD_PARTY_DIR} -type f -not -name 'LICENSE*' -delete -o -type d -empty -delete

```

- APK packages (Linux):
  - [go](https://pkgs.alpinelinux.org/packages?branch=edge&name=go)
